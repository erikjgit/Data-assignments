Slutpriser på ettor i Stockholms innerstad
================
Erik Johannesen

<img src="799px-Stockholm_från_Kungsholmen_2009.jpg" title="Bildkälla: Holger Ellgaard / Wikimedia commons" alt="Bildkälla: Holger Ellgaard / Wikimedia commons" width="100%" />

Ett API (Application Programming Interface) är ett gränssnitt som gör
det möjligt att kommunicera med en resurs, till exempel en databas.
Bostadssajten [Booli](https://www.booli.se/) har ett [öppet
API](https://www.booli.se/p/api/) där man kan söka efter och hämta deras
listade bostäder till salu och slutpriser. Vi har hämtat alla ettor i
Stockholms innerstad med slutpris, mer än 14000 objekt från 2012 till
2021. Det finns säkerligen mängder med felaktigheter i data, men dessa
bortser vi ifrån här.

Först läser vi in hela tabellen i R och skapar en översikt av
innehållet.

``` r
library(tidyverse)
booli_ettor <- read_csv("data/booli_ettor_2022-05-19.csv")
glimpse(booli_ettor)
```

    ## Rows: 16,507
    ## Columns: 29
    ## $ rooms                            <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
    ## $ constructionYear                 <dbl> 1928, 1945, 1929, 1927, 1930, 1907, 1…
    ## $ soldDate                         <date> 2022-05-18, 2022-05-18, 2022-05-17, …
    ## $ additionalArea                   <dbl> 0, 0, 0, 0, NA, NA, NA, 0, NA, 0, 0, …
    ## $ rent                             <dbl> 796, 1110, 1387, 2088, 1234, 1177, 16…
    ## $ livingArea                       <dbl> 31.0, 20.0, 36.0, 36.0, 36.0, 35.0, 2…
    ## $ soldPriceSource                  <chr> "bid", "bid", "maklare", "bid", "bobo…
    ## $ listPrice                        <dbl> 2995000, 1995000, 4300000, 3350000, N…
    ## $ soldPrice                        <dbl> 3750000, 2475000, 4140000, 3230000, 3…
    ## $ booliId                          <dbl> 4631955, 4626279, 4508558, 4584969, 4…
    ## $ objectType                       <chr> "Lägenhet", "Lägenhet", "Lägenhet", "…
    ## $ published                        <dttm> 2022-05-09 16:36:29, 2022-05-05 09:4…
    ## $ apartmentNumber                  <chr> "1001", "1001", NA, "1204", NA, NA, N…
    ## $ url                              <chr> "https://www.booli.se/annons/4631955"…
    ## $ floor                            <dbl> NA, NA, 1, 2, 3, 3, NA, 1, 3, 4, 5, 1…
    ## $ plotArea                         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
    ## $ source.id                        <dbl> 1451, 1566, 313076855, 58, 1573, 1570…
    ## $ source.url                       <chr> "https://widerlov.se/", "https://www.…
    ## $ source.type                      <chr> "Broker", "Broker", "Broker", "Broker…
    ## $ source.name                      <chr> "Widerlöv & Co", "Notar", "Alicia Ede…
    ## $ location.namedAreas              <chr> "Vasastan", "Södermalm", "Vasastan", …
    ## $ location.position.latitude       <dbl> 59.33749, 59.31870, 59.34156, 59.3333…
    ## $ location.position.longitude      <dbl> 18.06765, 18.01781, 18.06078, 18.0153…
    ## $ location.position.isApproximate  <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, T…
    ## $ location.region.municipalityName <chr> "Stockholm", "Stockholm", "Stockholm"…
    ## $ location.region.countyName       <chr> "Stockholms län", "Stockholms län", "…
    ## $ location.address.streetAddress   <chr> "Regeringsgatan 78", "Vindragarvägen …
    ## $ location.distance.ocean          <dbl> 784, 3175, 1383, 3163, 2542, 2158, 36…
    ## $ isNewConstruction                <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, N…

Sedan illustrerar vi prisutvecklingen genom att plotta priser per
kvadratmeter mot säljdatum tillsammans med en trendlinje.

``` r
ggplot(data = booli_ettor, 
       mapping = aes(x = soldDate, y = soldPrice / livingArea)) +
  geom_point(alpha = .1) +
  geom_smooth(se = FALSE, color = "steelblue") +
  ylab("Pris per kvadratmeter") + xlab("") +
  scale_y_continuous(expand = expansion(mult = c(0, .05)), limits = c(0, NA)) +
  ggtitle("Pris per kvadratmeter på ettor sålda i Stockholms innerstad enligt Booli") +
  theme_bw()
```

<img src="Booli_ettor_files/figure-gfm/unnamed-chunk-3-1.png" style="display: block; margin: auto;" />
